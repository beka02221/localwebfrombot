<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Tetris</title>
    <style>
        body { display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; background: #000; }
        canvas { background: #111; border: 1px solid #fff; }
    </style>
</head>
<body>
<canvas id="tetris" width="240" height="480"></canvas>
<script>
    const canvas = document.getElementById('tetris'), ctx = canvas.getContext('2d'), grid = 20;
    let field = Array.from({ length: 24 }, () => Array(12).fill(0)), tetro, pos = {x: 5, y: 0}, timer;

    const tetrominoes = [
        [[1,1,1],[0,1,0]],  // T
        [[1,1],[1,1]],      // O
        [[1,1,0],[0,1,1]],  // Z
        [[0,1,1],[1,1,0]],  // S
        [[1,1,1,1]],        // I
        [[1,1,1],[1,0,0]],  // L
        [[1,1,1],[0,0,1]]   // J
    ];

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        field.forEach((row, y) => row.forEach((value, x) => value && ctx.fillRect(x * grid, y * grid, grid - 1, grid - 1)));
        tetro.forEach((row, y) => row.forEach((value, x) => value && ctx.fillRect((pos.x + x) * grid, (pos.y + y) * grid, grid - 1, grid - 1)));
    }

    function collide() {
        return tetro.some((row, y) => row.some((value, x) => value && (field[pos.y + y] && field[pos.y + y][pos.x + x]) !== 0));
    }

    function merge() {
        tetro.forEach((row, y) => row.forEach((value, x) => value && (field[pos.y + y][pos.x + x] = value)));
    }

    function drop() {
        pos.y++;
        if (collide()) {
            pos.y--;
            merge();
            tetro = tetrominoes[Math.floor(Math.random() * tetrominoes.length)];
            pos = {x: 5, y: 0};
            if (collide()) clearInterval(timer);  // Game over
        }
        draw();
    }

    document.addEventListener('keydown', e => {
        if (e.key === 'ArrowLeft') pos.x--;
        if (e.key === 'ArrowRight') pos.x++;
        if (e.key === 'ArrowUp') tetro = tetro[0].map((_, i) => tetro.map(row => row[i])).reverse();
        if (e.key === 'ArrowDown') drop();
        if (collide()) pos.x += e.key === 'ArrowLeft' ? 1 : -1;
        draw();
    });

    tetro = tetrominoes[Math.floor(Math.random() * tetrominoes.length)];
    timer = setInterval(drop, 1000);
</script>
</body>
</html>